CREATE ALGORITHM=UNDEFINED DEFINER=`qa-general`@`%` SQL SECURITY DEFINER VIEW `detalleFacturacionRiders` AS select `p`.`IdPedido` AS `IdPedido`,`rf`.`IdRider` AS `IdRider`,`rf`.`FechaAsignacionRider` AS `Fecha`,`firstDayWeekByDate`(`rf`.`FechaAsignacionRider`) AS `FromDate`,`endDayWeekByDate`(`rf`.`FechaAsignacionRider`) AS `ToDate`,`p`.`Codigo` AS `Codigo`,`p`.`Corelativo` AS `Corelativo`,`c`.`RazonSocial` AS `Comercio`,`rf`.`IngresoTotalViaje` AS `TotalViajeOfertado`,`rf`.`TarifaBase` AS `TarifaBase`,`rf`.`PrecioDistanciaExtra` AS `IngresoExtra`,`rf`.`IngresoBono` AS `IngresoBono`,`rf`.`IngresoBruto` AS `IngresoBruto`,round(`rf`.`RetencionHonorarios`,0) AS `RetencionHonorarios`,round(`rf`.`IngresoNeto`,0) AS `IngresoNeto`,`rf`.`Propina` AS `Propina`,round(`rf`.`IngresoTotal`,0) AS `MontoDeposito`,`rf`.`IdRiderDeposito` AS `IdRiderDeposito` from ((`rider_facturacion_viajes` `rf` left join `pedidos` `p` on((`p`.`IdPedido` = `rf`.`IdPedido`))) left join `comercio` `c` on((`c`.`IdComercio` = `p`.`IdComercio`))) where (`p`.`IdEstado` = 12)