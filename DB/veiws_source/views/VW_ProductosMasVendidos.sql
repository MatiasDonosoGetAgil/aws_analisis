CREATE ALGORITHM=UNDEFINED DEFINER=`qa-general`@`%` SQL SECURITY DEFINER VIEW `VW_ProductosMasVendidos` AS select `PR`.`SKU` AS `SKU`,`PR`.`Nombre` AS `Nombre`,`C`.`Nombre` AS `Comercio`,`S`.`Titulo` AS `Sucursal`,sum(`D`.`Cantidad`) AS `Cantidad` from ((((`producto` `PR` left join `pedido_detalle` `D` on((`PR`.`IdProducto` = `D`.`IdProducto`))) left join `pedidos` `P` on((`P`.`IdPedido` = `D`.`IdPedido`))) left join `sucursal` `S` on((`S`.`IdSucursal` = `P`.`IdSucursal`))) left join `comercio` `C` on((`C`.`IdComercio` = `S`.`IdComercio`))) where ((`P`.`IdEstado` <> 2) and (`P`.`IdTipoPedido` = 1) and (date_format(`P`.`FechaCreacion`,'%Y-%m-%d') >= date_format((curdate() - interval 2 month),'%Y-%m-01'))) group by `PR`.`IdProducto`,`PR`.`Nombre`,`C`.`Nombre`,`S`.`Titulo` order by sum(`D`.`Cantidad`) desc