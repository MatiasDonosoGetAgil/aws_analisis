select '2022-05-01' AS `BASE DESDE`,(curdate() + interval -(7) day) AS `BASE HASTA`,`C`.`Nombre` AS `COMERCIO`,`C`.`RazonSocial` AS `RAZON SOCIAL`,concat(`C`.`Rut`,'-',`C`.`Dv`) AS `RUT COMERCIO`,`P`.`Codigo` AS `PEDIDO`,`P`.`FechaEntrega` AS `FECHA`,ifnull(`D`.`FechaDeposito`,'') AS `FECHA_DEPOSITO`,ifnull(`D`.`IdSucursalDeposito`,'') AS `NUMERO_DEPOSITO`,`P`.`TotalBoleta` AS `TOTAL BETA`,`P`.`SubtotalProductos` AS `SUBTOTAL`,`P`.`PropinaDelivery` AS `PROPINA`,round(`P`.`PagoEnvioCliente`,0) AS `GASTOS ENVIO`,round(`P`.`MedioPagoComisionBruto`,0) AS `COMISION PAGO`,round(`P`.`ComisionVentaBruto`,0) AS `COMISION VENTA BRUTO`,round(`P`.`ComisionVentaNeto`,0) AS `COMISION VENTA NETO`,round(`P`.`ComisionVentaIVA`,0) AS `COMISION VENTA IVA`,round(`P`.`ComisionDeliveryWebBruto`,0) AS `COMISION DELIVERY`,round(`P`.`TotalDescuentos`,0) AS `TOTAL DESCUENSTOS`,round(`P`.`MontoDepositoComercio`,0) AS `DEPOSITO A COMERCIO` from ((`dw_pedido` `P` left join `comercio` `C` on((`C`.`IdComercio` = `P`.`IdComercio`))) left join `sucursal_deposito` `D` on((`D`.`IdSucursalDeposito` = `P`.`IdSucursalDeposito`))) where ((`P`.`FechaFacturacionSucursal` >= '2022-05-01') and (`P`.`FechaFacturacionSucursal` <= (curdate() + interval -(7) day)) and (`P`.`IdEstadoPedido` in (8,9,10,11,12,3))) order by `C`.`Nombre`,`P`.`FechaEntrega`