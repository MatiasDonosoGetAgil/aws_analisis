select `r`.`Id_Rider` AS `IdRider`,`r`.`Id_Publico` AS `IdPublico`,`r`.`Nombre` AS `Nombre`,`r`.`Apellido` AS `Apellido`,`rb`.`IdRiderBanco` AS `IdRiderBanco`,`rb`.`Nombre` AS `NombreBanco`,`rb`.`Rut` AS `Rut`,`b`.`Nombre` AS `Banco`,`btc`.`Descripcion` AS `TipoCuenta`,`rb`.`NumeroCuenta` AS `NumeroCuenta`,`dfr`.`FromDate` AS `FromDate`,`dfr`.`ToDate` AS `ToDate`,count(0) AS `CantidadViajesRealizados`,ifnull(`rbr`.`CantidadBonos`,0) AS `CantidadDesafiosRealizados`,sum(`dfr`.`TotalViajeOfertado`) AS `TotalViajeOfertado`,sum(`dfr`.`TarifaBase`) AS `TarifaBase`,sum(`dfr`.`IngresoExtra`) AS `IngresoExtra`,sum(`dfr`.`IngresoBono`) AS `IngresoBonoDiario`,ifnull(`rbr`.`MontoBono`,0) AS `IngresoBonoDesafio`,(sum(`dfr`.`IngresoBono`) + ifnull(`rbr`.`MontoBono`,0)) AS `IngresoBono`,sum(`dfr`.`IngresoBruto`) AS `IngresoBrutoPedidos`,ifnull(`rbr`.`MontoBonoBruto`,0) AS `MontoBrutoBonoDesafio`,(sum(`dfr`.`IngresoBruto`) + ifnull(`rbr`.`MontoBonoBruto`,0)) AS `IngresoBruto`,round(sum(`dfr`.`RetencionHonorarios`),0) AS `RetencionHonorariosPedidos`,ifnull(`rbr`.`RetencionHonorariosBono`,0) AS `RetencionHonorariosBonoDesafio`,(round(sum(`dfr`.`RetencionHonorarios`),0) + ifnull(`rbr`.`RetencionHonorariosBono`,0)) AS `RetencionHonorarios`,ifnull(`rbr`.`MontoBonoNeto`,0) AS `MontoNetoBonoDesafio`,round(sum(`dfr`.`IngresoNeto`),0) AS `IngresoNetoPedidos`,(round(sum(`dfr`.`IngresoNeto`),0) + ifnull(`rbr`.`MontoBonoNeto`,0)) AS `IngresoNeto`,sum(`dfr`.`Propina`) AS `Propina`,round(sum(`dfr`.`MontoDeposito`),0) AS `MontoDepositoPedidos`,(round(sum(`dfr`.`MontoDeposito`),0) + ifnull(`rbr`.`MontoBonoNeto`,0)) AS `MontoDeposito` from (((((`detalleFacturacionRiders` `dfr` left join `rider` `r` on((`r`.`Id_Rider` = `dfr`.`IdRider`))) left join `rider_banco` `rb` on(((`rb`.`IdRider` = `r`.`Id_Rider`) and (`rb`.`IdEstado` = 1)))) left join `banco` `b` on((`b`.`IdBanco` = `rb`.`IdBanco`))) left join `banco_tipo_cuenta` `btc` on((`btc`.`IdTipoCuenta` = `rb`.`IdTipoCuenta`))) left join `resumenBonoRiders` `rbr` on(((`rbr`.`IdRider` = `dfr`.`IdRider`) and (`rbr`.`ToDate` = `dfr`.`ToDate`) and (`rbr`.`fromDate` = `dfr`.`FromDate`)))) where isnull(`dfr`.`IdRiderDeposito`) group by `dfr`.`IdRider`,`dfr`.`FromDate` order by `dfr`.`IdRider`