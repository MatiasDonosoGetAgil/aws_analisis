select `C`.`IdPedido` AS `IdPedido`,`C`.`CalificacionPedido` AS `CalificacionPedido`,(case when (`C`.`CalificacionRider` = 1) then 5 when (`C`.`CalificacionRider` = 2) then 1 end) AS `CalificacionRider`,`C`.`Comentario` AS `Comentario`,`C`.`FechaCalificacion` AS `FechaCalificacion`,`TC`.`Tipo` AS `Tipo`,`TC`.`Descripcion` AS `Descripcion`,(case when (`P`.`CalificacionProducto` = 1) then 5 when (`P`.`CalificacionProducto` = 2) then 1 end) AS `CalificacionProducto`,`TP`.`Descripcion` AS `DescripcionProducto`,`PR`.`SKU` AS `SKU`,`PR`.`Nombre` AS `Producto`,`S`.`Titulo` AS `Sucursal`,`CO`.`Nombre` AS `Comercio`,`PET`.`FechaEstimadaEntregaMax` AS `FechaEntrega` from (((((((((((`calificacion_cliente` `C` left join `calificacion_cliente_detalle` `DC` on(((`DC`.`IdCalificacion` = `C`.`IdCalificacion`) and isnull(`DC`.`IdCalificacionProducto`)))) left join `calificacion_cliente_tipo` `TC` on((`TC`.`IdTipo` = `DC`.`IdTipo`))) left join `calificacion_cliente_producto` `P` on((`P`.`IdCalificacion` = `C`.`IdCalificacion`))) left join `calificacion_cliente_detalle` `DP` on(((`DP`.`IdCalificacion` = `C`.`IdCalificacion`) and (`DP`.`IdCalificacionProducto` = `P`.`IdCalificacionProducto`)))) left join `calificacion_cliente_tipo` `TP` on((`TP`.`IdTipo` = `DP`.`IdTipo`))) left join `pedido_detalle` `PD` on(((`PD`.`Id` = `P`.`IdProductoDetalle`) and (`PD`.`IdPedido` = `C`.`IdPedido`)))) left join `producto` `PR` on((`PR`.`IdProducto` = `PD`.`IdProducto`))) left join `pedidos` `PE` on((`PE`.`IdPedido` = `C`.`IdPedido`))) left join `sucursal` `S` on((`S`.`IdSucursal` = `PE`.`IdSucursal`))) left join `comercio` `CO` on((`CO`.`IdComercio` = `S`.`IdComercio`))) left join `pedido_entrega` `PET` on((`PET`.`IdPedido` = `PE`.`IdPedido`))) where (date_format(`C`.`FechaCalificacion`,'%Y-%m-%d') >= date_format((curdate() - interval 2 month),'%Y-%m-01')) order by `C`.`IdPedido`